<!DOCTYPE html><html lang="et" dir="ltr"> <head> <meta charset="utf-8"/> <title>Tsoon</title> <script src="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"></script> <script src="https://unpkg.com/@turf/turf/turf.min.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-176949609-1" ></script> <link href="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css" rel="stylesheet"/> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous"/> <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet"/> <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"/> <meta name="description" content="Kas siin tohib parkida? Tallinna kesklinna elaniku parkimise soodustuse asukoha määramine."/> </head> <body> <div class="controls"> <span class="title">Kas tohid siin parkida?</span> <br/> <div id="permission"></div><br/> <br/> <span>Vali elukohajärgne tsoon: </span> <select id="zone"></select> <button type="button" class="button" id="locate"> Uuenda minu asukoht kaardil </button> </div><div class="map-wrapper"> <div id="map"></div></div></body> <style>*{box-sizing: border-box;}html, body, map-wrapper{height: 100vh; height: 100%; max-width: 960px; margin: 0 auto; text-align: center;}body{font-size: 20px; font-family: "Raleway", sans-serif; padding: 1px 0; background: #faf3dd;}.controls{padding: 8px;}.title{font-size: 22px; text-decoration: underline;}#permission{font-size: 22px; background: #68b0ab; padding: 0 8px; border-radius: 8px; visibility: hidden; margin-top: 4px; display: inline-block;}.map-wrapper{position: relative; margin: 8px;}#map{border: 1px solid black; border-radius: 4px; position: absolute; top: 0; left: 0; right: 0; height: 420px;}.button{background-color: #2ecc71; box-shadow: 0px 5px 0px 0px #15b358; border-radius: 5px; padding: 8px 10px; font-size: 18px; text-decoration: none; margin-top: 8px; color: #fff; position: relative; display: inline-block; border: 0; outline: none;}.button:hover{background-color: #48e68b;}.button:active{transform: translate(0px, 5px); -webkit-transform: translate(0px, 5px); box-shadow: 0px 1px 0px 0px;}</style> <script>let map, marker, polygonSources=[]; const defaultCenter=[24.753553, 59.43702]; const zones=[{title: "T1", lat: 59.436478, lng: 24.73958, boundingPolygonPoints: [{lng: 24.73900079727173, lat: 59.440045994174625},{lng: 24.737166166305542, lat: 59.43943503245784},{lng: 24.735776782035828, lat: 59.43894407308283},{lng: 24.734634160995483, lat: 59.43835491242821},{lng: 24.734164774417877, lat: 59.437885758643304},{lng: 24.733663201332092, lat: 59.437362044408424},{lng: 24.732810258865356, lat: 59.43633641388256},{lng: 24.732684195041656, lat: 59.4360418121329},{lng: 24.73268687725067, lat: 59.43572538517434},{lng: 24.732863903045654, lat: 59.43504887623349},{lng: 24.73307713866234, lat: 59.43475221734123},{lng: 24.733301103115082, lat: 59.43444464411141},{lng: 24.733770489692688, lat: 59.433911328691764},{lng: 24.734250605106354, lat: 59.43335072464967},{lng: 24.734827280044556, lat: 59.432806479724206},{lng: 24.73493993282318, lat: 59.43263188300652},{lng: 24.735267162322998, lat: 59.432457285388004},{lng: 24.736023545265198, lat: 59.432157193626466},{lng: 24.736844301223755, lat: 59.431895293187196},{lng: 24.740910530090332, lat: 59.432680988424416},{lng: 24.742053151130676, lat: 59.43296743527534},{lng: 24.74319577217102, lat: 59.43316658260955},{lng: 24.743675887584686, lat: 59.43316931064707},{lng: 24.744327664375305, lat: 59.43309565355642},{lng: 24.744909703731537, lat: 59.433076557247475},{lng: 24.745556116104126, lat: 59.43310110964269},{lng: 24.74645733833313, lat: 59.43399589589189},{lng: 24.748560190200806, lat: 59.43512525695252},{lng: 24.747841358184814, lat: 59.43554534782539},{lng: 24.74646806716919, lat: 59.436030900907724},{lng: 24.74595308303833, lat: 59.43647825825464},{lng: 24.746382236480713, lat: 59.43678922268177},{lng: 24.745910167694092, lat: 59.43689833232977},{lng: 24.74543809890747, lat: 59.43693652062343},{lng: 24.745116233825684, lat: 59.43711109513135},{lng: 24.74494457244873, lat: 59.43718747119532},{lng: 24.74466562271118, lat: 59.43719292662187},{lng: 24.74391460418701, lat: 59.43756934892906},{lng: 24.74344253540039, lat: 59.43769482210083},{lng: 24.74294900894165, lat: 59.43775483084459},{lng: 24.742804169654846, lat: 59.43788575864333},{lng: 24.742788076400757, lat: 59.43804941767926},{lng: 24.743013381958008, lat: 59.438114881071954},{lng: 24.742906093597412, lat: 59.4385294796177},{lng: 24.742541313171387, lat: 59.43869313553981},{lng: 24.742112159729004, lat: 59.438758597687006},{lng: 24.74168300628662, lat: 59.438824059707535},{lng: 24.74099636077881, lat: 59.439004079610854},{lng: 24.740374088287354, lat: 59.4392386495628},{lng: 24.739129543304443, lat: 59.440035084240705}]},{title: "T2", lat: 59.438965, lng: 24.74872, boundingPolygonPoints: [{lng: 24.739043712615967, lat: 59.44008963387504},{lng: 24.741661548614502, lat: 59.441060602649145},{lng: 24.742825627326965, lat: 59.441540621861016},{lng: 24.744096994400024, lat: 59.44197699705208},{lng: 24.745781421661377, lat: 59.441944269108},{lng: 24.747830629348755, lat: 59.44250609442082},{lng: 24.748651385307312, lat: 59.44273245829321},{lng: 24.749515056610107, lat: 59.442937002658184},{lng: 24.7501802444458, lat: 59.44308972831081},{lng: 24.750823974609375, lat: 59.44300245659374},{lng: 24.75143551826477, lat: 59.44258791286275},{lng: 24.752111434936523, lat: 59.441971542396935},{lng: 24.75290536880493, lat: 59.441044238237744},{lng: 24.75346326828003, lat: 59.44046875140371},{lng: 24.753763675689697, lat: 59.44041692983392},{lng: 24.7537100315094, lat: 59.439669599421826},{lng: 24.753795862197876, lat: 59.43887861129455},{lng: 24.753570556640625, lat: 59.43802214122824},{lng: 24.753270149230957, lat: 59.43760480878567},{lng: 24.753044843673706, lat: 59.43734567820795},{lng: 24.75296437740326, lat: 59.43703744662067},{lng: 24.753149449825287, lat: 59.4368778742976},{lng: 24.753259420394897, lat: 59.43670739021487},{lng: 24.752647876739502, lat: 59.43643461389577},{lng: 24.751499891281128, lat: 59.43608545699841},{lng: 24.750373363494873, lat: 59.43571992951119},{lng: 24.748528003692627, lat: 59.435136168469725},{lng: 24.74774479866028, lat: 59.435588993331294},{lng: 24.747042059898376, lat: 59.435799036541034},{lng: 24.74647879600525, lat: 59.436060906768496},{lng: 24.74594235420227, lat: 59.43647280271285},{lng: 24.74646806716919, lat: 59.436767400709975},{lng: 24.745888710021973, lat: 59.43691469874662},{lng: 24.74543809890747, lat: 59.43693652062343},{lng: 24.745116233825684, lat: 59.43711109513135},{lng: 24.74494457244873, lat: 59.43718747119532},{lng: 24.744628071784973, lat: 59.437231114583035},{lng: 24.74391460418701, lat: 59.43756934892906},{lng: 24.74294364452362, lat: 59.43776301384684},{lng: 24.74277064204216, lat: 59.438048735768255},{lng: 24.742919504642487, lat: 59.438105334335106},{lng: 24.742906093597412, lat: 59.4385294796177},{lng: 24.742541313171387, lat: 59.43869313553981},{lng: 24.742112159729004, lat: 59.438758597687006},{lng: 24.74168300628662, lat: 59.438824059707535},{lng: 24.740374088287354, lat: 59.4392386495628},{lng: 24.739129543304443, lat: 59.440035084240705}]},{title: "T3", lat: 59.430588, lng: 24.747391, boundingPolygonPoints: [{lng: 24.736881852149963, lat: 59.43187619620087},{lng: 24.737364649772644, lat: 59.43197577322543},{lng: 24.737547039985657, lat: 59.431988049824554},{lng: 24.73910003900528, lat: 59.432244493322436},{lng: 24.7401125729084, lat: 59.432375442444204},{lng: 24.741071462631226, lat: 59.43258823368632},{lng: 24.742310643196106, lat: 59.432918330273104},{lng: 24.742841720581055, lat: 59.43309019746921},{lng: 24.74345326423645, lat: 59.43312702604054},{lng: 24.744043350219727, lat: 59.433054732881175},{lng: 24.745255708694458, lat: 59.43300289995488},{lng: 24.745561480522156, lat: 59.43297561943547},{lng: 24.74593162536621, lat: 59.433024724354574},{lng: 24.746038913726807, lat: 59.43339846501503},{lng: 24.746291041374207, lat: 59.433753105620575},{lng: 24.74657267332077, lat: 59.43399453190648},{lng: 24.746886491775513, lat: 59.434178669441266},{lng: 24.7479110956192, lat: 59.43472971207771},{lng: 24.749163687229156, lat: 59.434406453005245},{lng: 24.750126600265503, lat: 59.4341377500757},{lng: 24.750298261642456, lat: 59.434020447620156},{lng: 24.751033186912537, lat: 59.43426596392245},{lng: 24.753055572509766, lat: 59.43300835605613},{lng: 24.75316286087036, lat: 59.432966071248515},{lng: 24.75296974182129, lat: 59.432885593565366},{lng: 24.753055572509766, lat: 59.432675532270395},{lng: 24.75341498851776, lat: 59.43243273252565},{lng: 24.75373148918152, lat: 59.43221175596284},{lng: 24.75445568561554, lat: 59.431540633111574},{lng: 24.755281805992126, lat: 59.43090496382916},{lng: 24.756268858909607, lat: 59.43016015158238},{lng: 24.757041335105896, lat: 59.42957629462424},{lng: 24.756279587745667, lat: 59.42936348444323},{lng: 24.75473865866661, lat: 59.42906609361547},{lng: 24.753154814243317, lat: 59.428834181523534},{lng: 24.751581698656082, lat: 59.42859408262474},{lng: 24.74995493888855, lat: 59.42833215461072},{lng: 24.74769651889801, lat: 59.42796927182532},{lng: 24.74655658006668, lat: 59.42778510050226},{lng: 24.745400547981262, lat: 59.42759274271714},{lng: 24.744003117084503, lat: 59.42737309880303},{lng: 24.742584228515625, lat: 59.42725168012698},{lng: 24.742541313171387, lat: 59.427857404918974},{lng: 24.7424179315567, lat: 59.428479489368016},{lng: 24.740577936172485, lat: 59.430678520814354},{lng: 24.738898873329163, lat: 59.43115868733501},{lng: 24.73844289779663, lat: 59.431303281600336},{lng: 24.73699450492859, lat: 59.43180526444308},{lng: 24.73696231842041, lat: 59.431854371060446},{lng: 24.737053513526917, lat: 59.43190347760658},{lng: 24.737021327018738, lat: 59.43185982734689}]},{title: "T4", lat: 59.433487, lng: 24.756725, boundingPolygonPoints: [{lng: 24.74792718887329, lat: 59.43472425625406},{lng: 24.749069809913635, lat: 59.43444464411141},{lng: 24.749748408794403, lat: 59.43426391796063},{lng: 24.750098437070847, lat: 59.43414627494761},{lng: 24.750319719314575, lat: 59.43402317558883},{lng: 24.751054644584656, lat: 59.43428233161257},{lng: 24.75315749645233, lat: 59.432967435275366},{lng: 24.752961695194244, lat: 59.43287468132243},{lng: 24.753039479255676, lat: 59.43272463762493},{lng: 24.753334522247314, lat: 59.4324627415772},{lng: 24.75372076034546, lat: 59.43221175596284},{lng: 24.754375219345093, lat: 59.431589740112976},{lng: 24.755265712738037, lat: 59.4309349742355},{lng: 24.757035970687866, lat: 59.429647231053885},{lng: 24.759310483932495, lat: 59.43038932632721},{lng: 24.75993275642395, lat: 59.43067306433744},{lng: 24.760490655899048, lat: 59.43097862568815},{lng: 24.761842489242554, lat: 59.43183527405104},{lng: 24.762775897979736, lat: 59.43253912813382},{lng: 24.76339817047119, lat: 59.43319386297501},{lng: 24.76392388343811, lat: 59.433930424529606},{lng: 24.764331579208374, lat: 59.43488520268352},{lng: 24.76466417312622, lat: 59.43544168952327},{lng: 24.76465344429016, lat: 59.437367499806776},{lng: 24.764251112937927, lat: 59.4382294417044},{lng: 24.763859510421753, lat: 59.43911863723241},{lng: 24.763505458831787, lat: 59.439860524819785},{lng: 24.76345181465149, lat: 59.43996689707411},{lng: 24.763247966766357, lat: 59.43997507954137},{lng: 24.76290464401245, lat: 59.43987688980378},{lng: 24.762314558029175, lat: 59.43970232956657},{lng: 24.761617183685303, lat: 59.43959868399956},{lng: 24.760324358940125, lat: 59.43950322069646},{lng: 24.759246110916138, lat: 59.43957140879761},{lng: 24.757867455482483, lat: 59.43973437780263},{lng: 24.756563901901245, lat: 59.439984625750654},{lng: 24.7546648979187, lat: 59.440545119888164},{lng: 24.754085540771484, lat: 59.44064058025135},{lng: 24.753785133361816, lat: 59.44056966686444},{lng: 24.75372076034546, lat: 59.4401414559462},{lng: 24.753849506378174, lat: 59.438810421797015},{lng: 24.753833413124084, lat: 59.438439468523086},{lng: 24.75367784500122, lat: 59.438093059955115},{lng: 24.753486067056656, lat: 59.437824386300775},{lng: 24.753262102603912, lat: 59.437610264144894},{lng: 24.753082394599915, lat: 59.43751479523099},{lng: 24.753007292747498, lat: 59.43724066156661},{lng: 24.752999246120453, lat: 59.43712541565652},{lng: 24.753044843673706, lat: 59.436982892064975},{lng: 24.75317895412445, lat: 59.43684786916132},{lng: 24.753377437591553, lat: 59.436712845718816},{lng: 24.7507381439209, lat: 59.43580585610384},{lng: 24.748549461364746, lat: 59.43510616178892},{lng: 24.748262465000153, lat: 59.4349220293013}]},{title: "T5", lat: 59.444595, lng: 24.760481, boundingPolygonPoints: [{lng: 24.74782794713974, lat: 59.444321053694104},{lng: 24.748371094465256, lat: 59.444987150681186},{lng: 24.748639985919, lat: 59.445310649552056},{lng: 24.74894106388092, lat: 59.44564232642543},{lng: 24.74885255098343, lat: 59.445740499429085},{lng: 24.749285727739334, lat: 59.446112736145984},{lng: 24.749529138207436, lat: 59.44626749269628},{lng: 24.75020170211792, lat: 59.44640043277979},{lng: 24.751526713371277, lat: 59.44651496535582},{lng: 24.751639366149902, lat: 59.44722396790874},{lng: 24.751510620117188, lat: 59.44740939689374},{lng: 24.75265860557556, lat: 59.44745848086665},{lng: 24.752508401870728, lat: 59.44870191775287},{lng: 24.753817319869995, lat: 59.44874009272342},{lng: 24.753828048706055, lat: 59.448478320631494},{lng: 24.75418210029602, lat: 59.44846741341703},{lng: 24.754267930984497, lat: 59.447709353393485},{lng: 24.75593090057373, lat: 59.44823290745514},{lng: 24.756252765655518, lat: 59.44856830501665},{lng: 24.756134748458862, lat: 59.44916001455524},{lng: 24.75666046142578, lat: 59.44918728202639},{lng: 24.758076667785645, lat: 59.449519943403935},{lng: 24.758892059326172, lat: 59.44954721058486},{lng: 24.759600162506104, lat: 59.44942178137055},{lng: 24.760061502456665, lat: 59.449236363419004},{lng: 24.76017951965332, lat: 59.448260175673774},{lng: 24.760608673095703, lat: 59.44754028732987},{lng: 24.760812520980835, lat: 59.44734940527454},{lng: 24.761273860931396, lat: 59.44719124504116},{lng: 24.763569831848145, lat: 59.44804202930895},{lng: 24.766573905944824, lat: 59.44904549093638},{lng: 24.769277572631836, lat: 59.44941632791592},{lng: 24.771766662597656, lat: 59.44993985555247},{lng: 24.773826599121094, lat: 59.449830787963215},{lng: 24.775371551513672, lat: 59.4496126517294},{lng: 24.7756290435791, lat: 59.44930725863818},{lng: 24.77541446685791, lat: 59.449001862789075},{lng: 24.77193832397461, lat: 59.44935088639147},{lng: 24.76241111755371, lat: 59.44546779593758},{lng: 24.763011932373047, lat: 59.444796935991214},{lng: 24.765232801437378, lat: 59.4451623654168},{lng: 24.765501022338867, lat: 59.445249631561325},{lng: 24.76738929748535, lat: 59.44555506129407},{lng: 24.76738929748535, lat: 59.44540234677245},{lng: 24.76670265197754, lat: 59.4448787488922},{lng: 24.76369857788086, lat: 59.444376959984396},{lng: 24.763805866241455, lat: 59.44417515147688},{lng: 24.763312339782715, lat: 59.444049702338326},{lng: 24.763526916503906, lat: 59.44385334623092},{lng: 24.757604598999023, lat: 59.44264791292772},{lng: 24.758548736572266, lat: 59.44141789032427},{lng: 24.760823249816895, lat: 59.441971542396935},{lng: 24.760308265686035, lat: 59.442893366630734},{lng: 24.765372276306152, lat: 59.44374425901202},{lng: 24.767560958862305, lat: 59.444136971353544},{lng: 24.768311977386475, lat: 59.4444315026176},{lng: 24.771080017089844, lat: 59.44592593654736},{lng: 24.77163791656494, lat: 59.445882304375694},{lng: 24.769749641418457, lat: 59.443995159089496},{lng: 24.77144479751587, lat: 59.443547901131524},{lng: 24.772496223449707, lat: 59.44452967913566},{lng: 24.774255752563477, lat: 59.44544597956328},{lng: 24.774556159973145, lat: 59.4456423264254},{lng: 24.776122570037842, lat: 59.446045924729226},{lng: 24.777045249938965, lat: 59.446122280623314},{lng: 24.779491424560547, lat: 59.44520599851722},{lng: 24.780864715576172, lat: 59.444900565632366},{lng: 24.781551361083984, lat: 59.44431150870849},{lng: 24.781572818756104, lat: 59.44407151961323},{lng: 24.780735969543457, lat: 59.44295882065077},{lng: 24.781615734100342, lat: 59.44160607849849},{lng: 24.782023429870605, lat: 59.43981688482383},{lng: 24.78015661239624, lat: 59.439593228960966},{lng: 24.77838635444641, lat: 59.43938048176804},{lng: 24.77563977241516, lat: 59.43914591279947},{lng: 24.774523973464966, lat: 59.439004079610854},{lng: 24.77291464805603, lat: 59.4387913287131},{lng: 24.772303104400635, lat: 59.43868222516966},{lng: 24.771498441696167, lat: 59.43858948688108},{lng: 24.770768880844116, lat: 59.438513113981934},{lng: 24.769116640090942, lat: 59.4382294417044},{lng: 24.765737056732178, lat: 59.43769482210085},{lng: 24.764621257781982, lat: 59.437591170383676},{lng: 24.764090180397034, lat: 59.43876132527375},{lng: 24.763569831848145, lat: 59.43984961482608},{lng: 24.76343035697937, lat: 59.43996689707411},{lng: 24.76291000843048, lat: 59.43987143480999},{lng: 24.762057065963745, lat: 59.439661416880696},{lng: 24.7607159614563, lat: 59.43953322347791},{lng: 24.75931853055954, lat: 59.439552998023835},{lng: 24.75822150707245, lat: 59.439687328254166},{lng: 24.75753754377365, lat: 59.43978892792178},{lng: 24.756864309310913, lat: 59.43991234724184},{lng: 24.755623787641525, lat: 59.440258737182496},{lng: 24.754383265972137, lat: 59.440673309456706},{lng: 24.754101634025574, lat: 59.44072785806192},{lng: 24.753439128398895, lat: 59.440561484541014},{lng: 24.752250909805298, lat: 59.44180790233355},{lng: 24.751296043395996, lat: 59.44272427649284},{lng: 24.750893712043762, lat: 59.442939729908005},{lng: 24.750477969646454, lat: 59.44303109265069},{lng: 24.749808758497238, lat: 59.443033138082406},{lng: 24.749399051070213, lat: 59.44294143443906},{lng: 24.74947314709425, lat: 59.444008283566795},{lng: 24.747782349586487, lat: 59.444247420878085}]},{title: "T6", lat: 59.436172, lng: 24.776573, boundingPolygonPoints: [{lng: 24.764567613601685, lat: 59.43751479523099},{lng: 24.775355458259583, lat: 59.43911045455806},{lng: 24.777259826660156, lat: 59.43924819597992},{lng: 24.779083728790283, lat: 59.43943775999006},{lng: 24.781004190444946, lat: 59.43967778196102},{lng: 24.781765937805176, lat: 59.43976778976108},{lng: 24.782192409038544, lat: 59.43984143232844},{lng: 24.782479405403137, lat: 59.439942349660456},{lng: 24.78406995534897, lat: 59.44029146675726},{lng: 24.7856605052948, lat: 59.44068421918477},{lng: 24.785773158073425, lat: 59.44054511988819},{lng: 24.785499572753906, lat: 59.438660404418734},{lng: 24.784212112426758, lat: 59.43746024144496},{lng: 24.785027503967285, lat: 59.43722020374139},{lng: 24.785027503967285, lat: 59.4369583424862},{lng: 24.784083366394043, lat: 59.43599816721112},{lng: 24.7871732711792, lat: 59.4349506721985},{lng: 24.786819219589233, lat: 59.434574220757455},{lng: 24.78663682937622, lat: 59.43369581777445},{lng: 24.78641152381897, lat: 59.43288286550497},{lng: 24.78614330291748, lat: 59.432550040484976},{lng: 24.784952402114868, lat: 59.432157193626416},{lng: 24.783997535705566, lat: 59.431851642916904},{lng: 24.782302379608154, lat: 59.43221721219165},{lng: 24.781519174575806, lat: 59.43244091681509},{lng: 24.780800342559814, lat: 59.43261005835345},{lng: 24.777994751930237, lat: 59.43304654874019},{lng: 24.775995835661888, lat: 59.433298551173365},{lng: 24.774302691221237, lat: 59.43351781563377},{lng: 24.77102369070053, lat: 59.43392906054153},{lng: 24.764326214790344, lat: 59.43475699118304},{lng: 24.76470708847046, lat: 59.43564900580998},{lng: 24.764578342437744, lat: 59.43738386599672}]},{title: "T7", lat: 59.430565, lng: 24.769665, boundingPolygonPoints: [{lng: 24.764572978019714, lat: 59.43470516086413},{lng: 24.768113493919373, lat: 59.434313702996604},{lng: 24.771611094474792, lat: 59.43386768102186},{lng: 24.77513015270233, lat: 59.43341074109808},{lng: 24.77864921092987, lat: 59.43291014609913},{lng: 24.77891743183136, lat: 59.43184345848495},{lng: 24.778976440429688, lat: 59.43166340048143},{lng: 24.778729677200317, lat: 59.43162247807425},{lng: 24.778568744659424, lat: 59.43067306433744},{lng: 24.77793574333191, lat: 59.430203804034385},{lng: 24.77713108062744, lat: 59.429581751277944},{lng: 24.776026010513306, lat: 59.428757786604116},{lng: 24.77570414543152, lat: 59.42813570727007},{lng: 24.771584272384644, lat: 59.42699656306281},{lng: 24.765983819961548, lat: 59.4278628618498},{lng: 24.76439595222473, lat: 59.42792288803096},{lng: 24.76339817047119, lat: 59.427944715706815},{lng: 24.762293100357056, lat: 59.42799382792602},{lng: 24.759621620178223, lat: 59.42887237891858},{lng: 24.758859872817993, lat: 59.429011526207404},{lng: 24.758012294769287, lat: 59.429150672924116},{lng: 24.757068157196045, lat: 59.42956538131416},{lng: 24.757626056671143, lat: 59.429723623965685},{lng: 24.7581946849823, lat: 59.42989823568803},{lng: 24.759541153907776, lat: 59.43048208709233},{lng: 24.760866165161133, lat: 59.431131405328905},{lng: 24.762775897979736, lat: 59.43253367195689},{lng: 24.76369857788086, lat: 59.433548505724815},{lng: 24.764342308044434, lat: 59.434746079543565}]},{title: "T8", lat: 59.423512, lng: 24.754601, boundingPolygonPoints: [{lng: 24.769803285598755, lat: 59.42105192754699},{lng: 24.765018224716187, lat: 59.41960551911394},{lng: 24.762539863586426, lat: 59.41892322953713},{lng: 24.760318994522095, lat: 59.41816996587607},{lng: 24.757792353630066, lat: 59.417542233357494},{lng: 24.756507575511932, lat: 59.41723928002209},{lng: 24.75584104657173, lat: 59.417090531671555},{lng: 24.755120873451233, lat: 59.416974534797966},{lng: 24.753302335739136, lat: 59.416636094589954},{lng: 24.75319504737854, lat: 59.41695270004792},{lng: 24.75171446800232, lat: 59.41694178266762},{lng: 24.7504323720932, lat: 59.41704003896369},{lng: 24.74919319152832, lat: 59.417225633411626},{lng: 24.747283458709717, lat: 59.4176459464892},{lng: 24.74543809890747, lat: 59.418262760130624},{lng: 24.74169373512268, lat: 59.41946360401442},{lng: 24.742149710655212, lat: 59.42066986340026},{lng: 24.742409884929657, lat: 59.42124022900463},{lng: 24.742584228515625, lat: 59.421854248221244},{lng: 24.742584228515625, lat: 59.427268051209836},{lng: 24.744096994400024, lat: 59.42737173455066},{lng: 24.751124382019043, lat: 59.42849176723551},{lng: 24.75417137145996, lat: 59.428983560376686},{lng: 24.7557270526886, lat: 59.429229454267535},{lng: 24.756386876106262, lat: 59.429385140668685},{lng: 24.757025241851807, lat: 59.429562652986114},{lng: 24.758012294769287, lat: 59.429168407268506},{lng: 24.75944995880127, lat: 59.42890511950856},{lng: 24.760887622833252, lat: 59.42844674836628},{lng: 24.762239456176758, lat: 59.4279665433686},{lng: 24.766016006469727, lat: 59.42785740491895},{lng: 24.771578907966614, lat: 59.4269815561168},{lng: 24.771063923835754, lat: 59.42666777299443},{lng: 24.7706401348114, lat: 59.426375815650765},{lng: 24.770323634147644, lat: 59.425928324741015},{lng: 24.76964235305786, lat: 59.42500330953423},{lng: 24.770489931106567, lat: 59.42324598388431},{lng: 24.770865440368652, lat: 59.42261561658414},{lng: 24.77019488811493, lat: 59.421492660475074},{lng: 24.77014660835266, lat: 59.42110377877749},{lng: 24.76994812488556, lat: 59.4211078722923}]},{title: "T9", lat: 59.425697, lng: 24.735718, boundingPolygonPoints: [{lng: 24.742519855499268, lat: 59.42719710979366},{lng: 24.742505103349686, lat: 59.4265262285687},{lng: 24.74257618188858, lat: 59.42586624855303},{lng: 24.742525219917297, lat: 59.424442557921374},{lng: 24.74253460764885, lat: 59.42375252053059},{lng: 24.742501080036163, lat: 59.423013349699595},{lng: 24.742531925439835, lat: 59.422320554264104},{lng: 24.74245548248291, lat: 59.42161682877799},{lng: 24.74224090576172, lat: 59.42109832075697},{lng: 24.742026329040527, lat: 59.42057707574248},{lng: 24.741645455360413, lat: 59.4195045411234},{lng: 24.739003479480743, lat: 59.42050748483232},{lng: 24.736286401748657, lat: 59.42154314654328},{lng: 24.734017252922058, lat: 59.422288148419035},{lng: 24.731919765472412, lat: 59.423185949409024},{lng: 24.730594754219055, lat: 59.42387361066021},{lng: 24.72946286201477, lat: 59.424539428085126},{lng: 24.728904962539673, lat: 59.42492690596808},{lng: 24.726673364639282, lat: 59.42701157000215},{lng: 24.725342988967896, lat: 59.428261215424804},{lng: 24.72643733024597, lat: 59.42818481921213},{lng: 24.72743511199951, lat: 59.428250301690696},{lng: 24.729881286621094, lat: 59.42862136667626},{lng: 24.731909036636353, lat: 59.42894877357933},{lng: 24.7329443693161, lat: 59.42910429074882},{lng: 24.733872413635254, lat: 59.42933620098992},{lng: 24.735143780708313, lat: 59.42975295334134},{lng: 24.73642587661743, lat: 59.430186070232544},{lng: 24.73767578601837, lat: 59.43062463806657},{lng: 24.738252460956573, lat: 59.43089302786472},{lng: 24.73875403404236, lat: 59.43121052308608},{lng: 24.740524291992188, lat: 59.43071671612786},{lng: 24.742401838302612, lat: 59.42844674836628},{lng: 24.742519855499268, lat: 59.42737719155982}]},{title: "T10", lat: 59.432156, lng: 24.72868, boundingPolygonPoints: [{lng: 24.72325086593628, lat: 59.434159573743464},{lng: 24.725589752197266, lat: 59.434601499988126},{lng: 24.72644805908203, lat: 59.43470652482094},{lng: 24.727317094802856, lat: 59.434795181893605},{lng: 24.729108810424805, lat: 59.4349506721985},{lng: 24.73048210144043, lat: 59.4350379646881},{lng: 24.731691777706146, lat: 59.43495340009221},{lng: 24.73231539130211, lat: 59.43490429797181},{lng: 24.732906818389893, lat: 59.434904297971784},{lng: 24.735074043273926, lat: 59.4324627415772},{lng: 24.73872721195221, lat: 59.431215979476306},{lng: 24.738454967737198, lat: 59.430988856489186},{lng: 24.73808616399765, lat: 59.43081629656409},{lng: 24.737512841820717, lat: 59.43057314244897},{lng: 24.735931009054184, lat: 59.43001350621418},{lng: 24.734687134623528, lat: 59.42959300562346},{lng: 24.73409201949835, lat: 59.42940185176226},{lng: 24.73343789577484, lat: 59.429224338601394},{lng: 24.733160957694054, lat: 59.429153060240274},{lng: 24.731886237859726, lat: 59.42893444959357},{lng: 24.730280935764313, lat: 59.42868821250959},{lng: 24.728718549013138, lat: 59.428441973634186},{lng: 24.72793199121952, lat: 59.428316125096124},{lng: 24.727134704589844, lat: 59.42823938795305},{lng: 24.726330041885376, lat: 59.42820391828144},{lng: 24.725353717803955, lat: 59.428261215424804},{lng: 24.724135994911194, lat: 59.42931437421145},{lng: 24.72345471382141, lat: 59.430203804034385},{lng: 24.723100662231445, lat: 59.43089132272659},{lng: 24.722800254821777, lat: 59.431933487127495},{lng: 24.722929000854492, lat: 59.43303018045229}]},{title: "T11", lat: 59.43914, lng: 24.732412, boundingPolygonPoints: [{lng: 24.723241478204727, lat: 59.434158891754066},{lng: 24.725568294525146, lat: 59.434612411674216},{lng: 24.727123975753784, lat: 59.43477881445146},{lng: 24.72968816757202, lat: 59.4350106858093},{lng: 24.730782508850098, lat: 59.4350379646881},{lng: 24.732327461242676, lat: 59.43491793745683},{lng: 24.732917547225952, lat: 59.43490157007413},{lng: 24.732606410980225, lat: 59.436030900907724},{lng: 24.73294973373413, lat: 59.43660373547266},{lng: 24.73373830318451, lat: 59.4374384199059},{lng: 24.734526872634888, lat: 59.43825671798828},{lng: 24.735111594200134, lat: 59.43863721985546},{lng: 24.73573923110962, lat: 59.43890861462992},{lng: 24.737091064453125, lat: 59.4394459425853},{lng: 24.73895788192749, lat: 59.440052812881554},{lng: 24.740610122680664, lat: 59.440725130633766},{lng: 24.743850231170654, lat: 59.44194972376754},{lng: 24.74435046315193, lat: 59.44204245284524},{lng: 24.744659587740898, lat: 59.442047907488934},{lng: 24.744904339313507, lat: 59.44199881566386},{lng: 24.74524900317192, lat: 59.44197699705208},{lng: 24.745647311210632, lat: 59.44197699705208},{lng: 24.74613480269909, lat: 59.44205404396208},{lng: 24.746600836515427, lat: 59.442185636951194},{lng: 24.747516810894012, lat: 59.44244336681468},{lng: 24.748792201280594, lat: 59.44280200351604},{lng: 24.749113395810127, lat: 59.44288586668285},{lng: 24.74941313266754, lat: 59.442980638629265},{lng: 24.749458730220795, lat: 59.4439989089407},{lng: 24.747825264930725, lat: 59.44423173979476},{lng: 24.7477126121521, lat: 59.44425560231003},{lng: 24.744131863117218, lat: 59.444653762938394},{lng: 24.742961078882217, lat: 59.443383586890235},{lng: 24.742391109466553, lat: 59.4427679127384},{lng: 24.73973035812378, lat: 59.44289336663079},{lng: 24.738582372665405, lat: 59.442942457157656},{lng: 24.738056659698486, lat: 59.44297927500609},{lng: 24.73768651485443, lat: 59.44297041145366},{lng: 24.73742365837097, lat: 59.442934275408135},{lng: 24.73511427640915, lat: 59.44196199674829},{lng: 24.734607338905334, lat: 59.441854267098556},{lng: 24.73182588815689, lat: 59.44173017302614},{lng: 24.730830788612366, lat: 59.44139061658894},{lng: 24.72923755645752, lat: 59.44044965925564},{lng: 24.72746729850769, lat: 59.43951685832771},{lng: 24.72745656967163, lat: 59.43900680717782},{lng: 24.727402925491333, lat: 59.438330363844955},{lng: 24.727150797843933, lat: 59.43771391580358},{lng: 24.727037139236927, lat: 59.43758946558303},{lng: 24.72697712481022, lat: 59.4374431933688},{lng: 24.72666397690773, lat: 59.43718337962488},{lng: 24.72611278295517, lat: 59.43663646858349},{lng: 24.724372029304504, lat: 59.435588993331294},{lng: 24.723840951919556, lat: 59.43499704636163},{lng: 24.723588824272156, lat: 59.434686065463474},{lng: 24.72337156534195, lat: 59.43437371773713}]}]; async function getLngLat(){if (navigator.geolocation){const position=await new Promise(function(resolve, reject){navigator.geolocation.getCurrentPosition(resolve, reject);}); return [position.coords.longitude, position.coords.latitude];}return defaultCenter;}function mapLngLatToArray(points){return points.map(function(point){return [point.lng, point.lat];});}function getIsInChosenZone(position){const chosenZone=document.getElementById("zone").value; const polygonCoords=mapLngLatToArray( zones.find(function(zone){return zone.title===chosenZone;}).boundingPolygonPoints ); polygonCoords.push(polygonCoords[0]); return turf.inside(turf.point(position), turf.polygon([polygonCoords]));}function getIsInDowntownArea(position){for (let i=0; i < zones.length; ++i){const polygonCoords=mapLngLatToArray(zones[i].boundingPolygonPoints); polygonCoords.push(polygonCoords[0]); if (turf.inside(turf.point(position), turf.polygon([polygonCoords]))){return true;}}return false;}function updatePermissionLabel(lngLat){const isInChosenZone=getIsInChosenZone(lngLat); const permission=document.getElementById("permission"); permission.style.visibility="visible"; if (isInChosenZone){permission.innerHTML="Jah"; permission.style.background="#68b0ab";}else{if (getIsInDowntownArea(lngLat)){permission.innerHTML="Ei";}else{permission.innerHTML="Te&nbsp;ei&nbsp;asu&nbsp;kesklinnas";}permission.style.background="#ed6663";}}function initializeZoneSelector(){const zoneNode=document.getElementById("zone"); for (let i=1; i < 12; ++i){const optionNode=document.createElement("option"); const optionText="T" + i; optionNode.value=optionText; optionNode.innerHTML=optionText; zoneNode.append(optionNode);}const savedZone=localStorage.getItem("zone"); if (savedZone){zoneNode.value=savedZone;}zoneNode.addEventListener("change", async function(event){localStorage.setItem("zone", event.target.value); polygonSources.forEach(function(polygonSource){if (map.getLayer(polygonSource)){map.removeLayer(polygonSource);}if (map.getSource(polygonSource)){map.removeSource(polygonSource);}}); polygonSources=[]; addMapElements(false); const lngLat=await getLngLat(); updatePermissionLabel(lngLat);});}async function initializeLocatorButton(){document .getElementById("locate") .addEventListener("click", async function(){if (marker){marker.remove();}const lngLat=await getLngLat(); updatePermissionLabel(lngLat); marker=new mapboxgl.Marker().setLngLat(lngLat).addTo(map); map.flyTo({center: lngLat, essential: true, zoom: 16});});}function addMapPolygon(zone, isChosenZone){const polygonId="polygon_" + zone.title; map.addSource(polygonId,{type: "geojson", data:{type: "Feature", geometry:{type: "Polygon", coordinates: [mapLngLatToArray(zone.boundingPolygonPoints)]}}}); let fillColor="#333333"; if (isChosenZone){fillColor="#68b0ab";}const polygonLayer=map.addLayer({id: polygonId, type: "fill", source: polygonId, paint:{"fill-color": fillColor, "fill-opacity": 0.5}}); polygonSources.push(polygonId);}function addMapLabel(zone){const labelId="label_" + zone.title; map.addSource(labelId,{type: "geojson", data:{type: "FeatureCollection", features: [{type: "Feature", properties:{description: zone.title}, geometry:{type: "Point", coordinates: [zone.lng, zone.lat]}}]}}); map.addLayer({id: labelId, type: "symbol", source: labelId, layout:{"text-field": ["get", "description"], "text-variable-anchor": ["top", "bottom", "left", "right"], "text-radial-offset": 0.5, "text-justify": "auto", "text-size": 22}});}function addMapElements(addLabels){const zoneNode=document.getElementById("zone"); zones.forEach(function(zone){addMapPolygon(zone, zone.title===zoneNode.value); if (addLabels){addMapLabel(zone);}});}async function initializeMap(){mapboxgl.accessToken="pk.eyJ1IjoiNHQ0ZzRzIiwiYSI6ImNrZWZxNjk0bzBhemIydGxwNjh2cGc1bGkifQ.jqgXTPPmoCnVyDcbyX4MtQ"; map=new mapboxgl.Map({container: "map", style: "mapbox://styles/mapbox/streets-v11", center: defaultCenter, zoom: 13}); map.on("load", async function(){map.addControl(new mapboxgl.NavigationControl()); addMapElements(true); const lngLat=await getLngLat(); if (marker){marker.remove();}marker=new mapboxgl.Marker().setLngLat(lngLat).addTo(map); map.flyTo({center: lngLat, essential: true, zoom: 16}); updatePermissionLabel(lngLat);});}window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag("js", new Date()); gtag("config", "UA-176949609-1"); (function(){initializeZoneSelector(); initializeLocatorButton(); initializeMap();})(); </script></html>
